---
layout: post
title: Szabad navigáció okozta problémák webes környezetben
date: '2011-11-28T01:06:00.001+01:00'
author: István Viczián
tags:
- Maven
- DocBook
modified_time: '2012-11-16T11:05:58.755+01:00'
blogger_id: tag:blogger.com,1999:blog-7370998606556338092.post-912143685418710554
blogger_orig_url: http://www.jtechlog.hu/2011/11/szabad-navigacio-okozta-problemak-webes.html
---

<p>Technológiák: Servlet 3.0/JSP 2.2, DocBook 4.5, Docbkx Tools, Docbkx Maven Plugin, Maven 3</p>

<p>Legrégebb óta írt cikkem kerül most publikálásra, melynek címe "Szabad navigáció okozta problémák webes környezetben".</p>

<p>Ez a cikk azon problémával foglalkozik, mely a legtöbb webes alkalmazás fejlesztésekor felmerül, ugyanis nem biztosítható az, hogy a felhasználó olyan sorrendben nézze meg az oldalakat, ahogy azt az alkalmazás fejlesztője eltervezi. Használhatja a Vissza és Tovább műveleteket is navigációra, valamint újratöltheti az oldalt a Frissítés művelettel. Ezen műveletek elérhetők a böngésző szokásos gombjai között, billentyűkombinációval, de jobb kattintásra felugró menüben is. Sokan megszokásból, esetleg türelmetlenség (, a lassú válaszidő) miatt duplán kattintanak egy adott hivatkozásra. A felhasználó kézzel is beírhat egy url-t, vagy a Kedvencek közül is választhat egyet, ami szintén hibás működéshez vezethet, ha erre nem készülünk fel, és bízunk, hogy csak a felületi elemeket (űrlap elemek – gomb, legördülő menü, stb., hivatkozások) fogja használni. A böngészők és tűzfalak gyorsítótár beállításai is megzavarhatják az előre tervezett munkafolyamatot. A probléma a webes technológia, a http(s) protokoll, valamint a böngészők adta lehetőségek miatt jelentkezik.</p>

<p>A cikk egy jtechlog-repost példa projektre hivatkozik, mely <a href="https://github.com/vicziani/jtechlog-repost">letölthető a GitHub-ról</a>. Egyszerű webes alkalmazás, servlet 
controller és JSP view réteggel. Maven-nel build-elhető, és a letöltést követően a 'mvn jetty:run' paranccsal futtatható.</p>

<p>Példaprogrammal, szekvencia diagramokkal és forráskódokkal szemlélteti a webes alkalmazásokban gyakran felmerülő problémákat, melyek a szabad navigációból erednek. Ha te is találkoztál, vagy írtál olyan alkalmazást, ahol problémát okozott, ha a felhasználó véletlenszerűen használta a Vissza/Előre gombokat, ha a többszöri kattintás felesleges terhelést okozott a szerveren, ha Frissít gomb megnyomásakor a böngésző hibaüzenetet dobott fel, akkor a cikk neked való. Nem csak a problémákat, de a rá adott szabványos megoldásokat is ismerteti, mint a Redirect After Post, vagy a Synchronizer Token. Olyan ide kapcsolódó témákat is érint, mint a hosszú, aszinkron folyamatok kezelése, vagy a problémák megoldása AJAX környezetben.</p>

<p style="text-align: center"><a href="http://vicziani.github.com/artifacts/repost.pdf">Szabad navigáció okozta problémák webes környezetben cikk letöltése</a></p>

<p>A dokumentáció érdekessége, hogy <a href="http://www.docbook.org/">DocBook-ban</a> íródott, mely egy XML formátum könyvek, cikkek publikálására. Ugyanis meguntam a Word ezirányú képességeit, hogy hosszabb dokumentációnál elveszti a kontrollt, bizonyos dolgokat sokszor körülményes vele megcsinálni. Mivel az XML egy szöveges állomány, ilyen nem fordulhat elő a megfelelő tag-ek ismeretében. A DocBook XML állományból a Maven <a href="http://docbkx-tools.sourceforge.net/">Docbkx Tools</a> fordít PDF állományt. A háttérben először egy XSL-FO állomány generálódik le, majd azt fordítja az <a href="http://xmlgraphics.apache.org/fop/">Apache FOP</a> PDF-fé.</p>

<p>A DocBook forrást tartalmazó, és a PDF-fé build-elést elvégző Maven projekt szintén <a href="https://github.com/vicziani/jtechlog-repost-doc">elérhető a GitHub-on</a> jtechlog-repost-doc néven.</p>

<p>Ezzel kapcsolatban csak egy probléma merült fel, méghozzá az ékezetes karakterek problémája. Egy PDF megjelenítő ugyanis alapban 14 betűtípust ismer (<a href="http://en.wikipedia.org/wiki/Portable_Document_Format">"base fourteen fonts"</a>), és ebben nincsenek ékezetes karakterek. Ezért, ha ilyeneket akarunk, akkor azokat be kell építenünk (embedded font) a PDF állományba. Az Apache FOP ezt azonban bizonyos verziónál csak úgy tudja megtenni, ha a beépítendő betűtípus mellett egy metrics állomány is szerepel, mely egy XML és leírja a betűtípus tulajdonságait. Szerencsére a betűtípusból ilyent generálni is lehet a következő paranccsal: <code>java org.apache.fop.fonts.apps.TTFReader -fn sanf-serif micross.ttf micross-fcm.xml</code>, persze a megfelelő FOP CLASSPATH beállításával. Szerencsére ilyent nem kellett Maven-ből hívni, ugyanis a Docbkx Tools tartalmaz eszközt erre is, csak a következő részeket kellett a pom.xml-be beilleszteni (fontos a false ansi property).</p>

<pre class="brush: xml">
&lt;plugin&gt;
 &lt;groupId&gt;com.agilejava.docbkx&lt;/groupId&gt;
 &lt;artifactId&gt;docbkx-fop-support&lt;/artifactId&gt;
 &lt;version&gt;2.0.13&lt;/version&gt;
 &lt;executions&gt;
  &lt;execution&gt;
   &lt;phase&gt;generate-resources&lt;/phase&gt;
   &lt;goals&gt;
    &lt;goal&gt;generate&lt;/goal&gt;
   &lt;/goals&gt;
   &lt;configuration&gt;
    &lt;ansi&gt;false&lt;/ansi&gt;
   &lt;/configuration&gt;
  &lt;/execution&gt;
 &lt;/executions&gt;
&lt;/plugin&gt;

&lt;plugin&gt;
 &lt;groupId&gt;com.agilejava.docbkx&lt;/groupId&gt;
 &lt;artifactId&gt;docbkx-maven-plugin&lt;/artifactId&gt;
 &lt;version&gt;2.0.13&lt;/version&gt;
 
 &lt;!-- ... --&gt;
 
 &lt;configuration&gt;
  &lt;bodyFontFamily&gt;TimesNewRoman&lt;/bodyFontFamily&gt;
  &lt;monospaceFontFamily&gt;Courier&lt;/monospaceFontFamily&gt;
  &lt;titleFontFamily&gt;ArialBold&lt;/titleFontFamily&gt;
  &lt;fonts&gt;
   &lt;font&gt;
    &lt;name&gt;Arial&lt;/name&gt;
    &lt;style&gt;normal&lt;/style&gt;
    &lt;weight&gt;normal&lt;/weight&gt;
    &lt;embedFile&gt;${basedir}/src/fonts/Arial.ttf&lt;/embedFile&gt;
    &lt;metricsFile&gt;${basedir}/target/fonts/Arial-metrics.xml&lt;/metricsFile&gt;
   &lt;/font&gt;
   &lt;!-- ... --&gt;
</pre>